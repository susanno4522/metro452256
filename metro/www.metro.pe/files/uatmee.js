"use strict";var sTienda="Metro";class Ee{constructor(e){this.shop=e,this.productsImp={callCounter:0,products:[]}}static getCookie(e){var t=new RegExp(e+"=([^;]+)").exec(document.cookie);return null!=t?unescape(t[1]):null}static getLocal(e){return localStorage.getItem(e)}static setLocal(e,t){localStorage.setItem(e,t)}static removeLocal(e){localStorage.removeItem(e)}static productClick(e,t){dataLayer.push({event:"productClick",ecommerce:{currencyCode:"PEN",click:{actionField:{list:e},products:[t]}}}),dataLayer.push({ecommerce:void 0})}static productListClick(e,t){dataLayer.push({event:"productClick",ecommerce:{currencyCode:"PEN",click:{actionField:{list:e},products:t}}}),dataLayer.push({ecommerce:void 0})}static addCart(e){dataLayer.push({event:"addToCart",ecommerce:{currencyCode:"PEN",add:{products:[e]}}}),dataLayer.push({ecommerce:void 0})}static listAddCart(e){dataLayer.push({event:"addToCart",ecommerce:{currencyCode:"PEN",add:{products:e}}}),dataLayer.push({ecommerce:void 0})}static removeCart(e){dataLayer.push({event:"removeFromCart",ecommerce:{currencyCode:"PEN",remove:{products:[e]}}}),dataLayer.push({ecommerce:void 0})}static productDetail(e,t){dataLayer.push({event:"productDetail",ecommerce:{currencyCode:"PEN",detail:{actionField:{list:e},products:[t]}}}),dataLayer.push({ecommerce:void 0})}static quitarAcentos(e){const t={"á":"a","é":"e","í":"i","ó":"o","ú":"u","Á":"A","É":"E","Í":"I","Ó":"O","Ú":"U"};return e.split("").map((e=>t[e]||e)).join("").toString()}static quitarEspacios(e){const t={" ":"-"};return e.split("").map((e=>t[e]||e)).join("").toString()}static buscarPrecioEnFicha(e){return Ee.fixPrecio(1*$(e).find(".product-prices__wrapper .plugin-preco .price-best-price .skuBestPrice").text().replace(/([^0-9|.]+)/gi,""))}static formatPrice(e){return 1*e.replace(/([^0-9|.]+)/gi,"")}static fixPrecio(e){return Number.parseFloat(e).toFixed(2)}static purchase(e,t){dataLayer.push({event:"purchase",ecommerce:{currencyCode:"PEN",purchase:{actionField:e,products:t}}}),dataLayer.push({ecommerce:void 0})}static checkout(e,t){dataLayer.push({event:"checkout",ecommerce:{currencyCode:"PEN",checkout:{actionField:e,products:t}}}),dataLayer.push({ecommerce:void 0})}static checkoutOption(e,t){dataLayer.push({event:"checkoutOption",ecommerce:{checkout_option:{actionField:{step:e,option:t}}}}),dataLayer.push({ecommerce:void 0})}static Search(e,t){var r=[];return $(e+">.product-item--search").each((function(e){r.push({name:$(this).attr("data-name").replace(/"/g,""),id:$(this).attr("data-refid"),price:Ee.fixPrecio(Ee.formatPrice($(this).attr("data-price"))),brand:"."!=$(this).attr("data-brand")?$(this).attr("data-brand"):sTienda,category:$(this).attr("data-category"),sku:$(this).attr("data-sku"),variant:"",list:t,position:e+1})})),r}static getSearchPosition(e){var t="";return $(".search-text-products>.product-item--search").each((function(r){$(this).attr("data-refid")==e&&(t=r+1)})),t}static impress(e){dataLayer.push({event:"impressions",ecommerce:{currencyCode:"PEN",impressions:e}}),dataLayer.push({ecommerce:void 0})}static promotions(e){dataLayer.push({event:"promotionsView",ecommerce:{promoView:{promotions:e}}}),dataLayer.push({ecommerce:void 0})}static formatImageName(e){if(void 0!==e)return e.replace("https://wongfood.vtexassets.com/arquivos/","")}static getLists(e){var t=document;if("/checkout"===location.pathname.toLowerCase())return[];var r=function(e){return t.querySelector(e)||{}},a=function(e){return r(e).innerText||""};if(e.match(/home/))return[{name:"Listas Sugeridas",subList:a(".shop-list__filters-wrapper .shop-list-filters__filter--active .shop-list-filters__name")}];if(e.match("category")){var o=a(".select2-selection__placeholder")||a(".select2-selection__rendered"),i=t.querySelectorAll(".active-filters .filter")||[];return[{name:"",order:o,type:"Grilla",filters:Array.from(i).map((function(e){return e&&e.innerText})).join()}]}return e.match("department")?[{name:vtxctx&&vtxctx.categoryName,subList:a('.product-shelf[class*="colunas"] h2')}]:[]}static getParList(){var e=window.location.href;"-1"!=(e=(e=(e=e.split("/").reverse())[0]).replace("?ft=","")).indexOf("?P")&&(e=(e=e.split("?"))[0]);var t=$(".title-wrapper .category-name-wrapper span .titulo-sessao").text(),r=$(".title-wrapper .category-name-wrapper .category-name").text();return t&&(e=t),r&&(e=r),e=e.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})),Ee.setLocal("lastCatalogo",e),e}static formatProductData(e,t,r,a){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],n=(Ee.getLists(e),function(e){return t.querySelector(e)||{}}),c=function(e){return n(e).innerText||""},s=function(e){return n(e).dataset||{}},d=c(".product-prices__value--best-price").replace("S/","")||"",p=s(".product-prices__value").price||"",u=s(".product-item").sku||"",l=r,m=i?d:p,h=c(".product-item__brand")||"",f=c(".product-item__name"),g=s(".product-item").uri||"",v=s(".product-item").category||"";if(0!=g){var y=(g=g.substring(g.length-2,0)).split("-");g=y[y.length-1]}""!=h&&(h="."!=h?h.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):"Wong");var _=v;o=_.indexOf(".pe/");return o+=3,v=_.substr(o),{id:g,name:f,price:m,brand:h,list:a=a.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})),sku:u,category:v,variant:"",position:l}}static formatProductListData(e,t,r,a){var o=Ee.getLists(e).find((function(e){return e.name===a})),i=function(e){return t.querySelector(e)||{}},n=function(e){return i(e).innerText||""},c=t.dataset.sku||"",s=t.dataset.reference_id||"",d=t.dataset.category||"",p=(i(".product-prices__value").dataset||{}).price||"",u=r+1,l=n(".product-item__brand");return"."==l&&(l=sTienda),{id:s,sku:c,name:n(".product-item__name"),price:p,brand:l,variant:"",list:JSON.stringify(o||{}),category:d,position:u}}getProducts(e){var t=[];if(void 0!==e&&e.items)for(var r,a=e.items[Symbol.iterator]();!(r=a.next()).done;!0){var o=(e=r.value).additionalInfo.brandName||"";""!=o&&(o="."!=o?o.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),t.push({name:e.name,id:e.productRefId,price:Ee.fixPrecio(e.price/100),brand:o,category:Object.values(e.productCategories).join("/"),sku:e.id,variant:"",quantity:e.quantity})}return t}getStore(){return Ee.getCookie("store-name")?Ee.getCookie("store-name"):sTienda}getShippingMethod(e){return e.shippingData.logisticsInfo[0].selectedSla}getWindowSelected(e){return e.shippingData.logisticsInfo[0].deliveryWindow}onInteraction(e){dataLayer.push({event:"PageviewVirtual",pagina:e}),dataLayer.push({ecommerce:void 0})}onPurchase(e,t){Ee.purchase(e,t)}onCheckout(e,t){var r=this.getProducts(t),a=0;if(r)if(r.length>20){a=r.length/20;for(var o=0;o<a;o++){for(var i=[],n=20*o,c=0;c<20;c++){var s=n+c;if(!r[s])break;i.push(r[s])}Ee.checkout(e,i)}}else Ee.checkout(e,r)}onCheckoutOption(e,t){Ee.checkoutOption(e,t)}onSingleClick(e,t){Ee.productClick(e,t)}onProductClick(e){var t=e.offsetParent,r=void 0,a=(m=function(e){return t.querySelector(e)||{}})(".product-prices__price.product-prices__price--better-price span.product-prices__value").innerText||"",o=t.dataset&&t.dataset.name||"",i=t.dataset&&t.dataset.brand||"",n=t.dataset&&t.dataset.sku||"",c=t.dataset&&t.dataset.refid||"",s=t.dataset&&t.dataset.category||"",d=m("a").href;""!=i&&(i="."!=i?i.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),""==a&&(a=m(".product-prices__price.product-prices__price--regular-price span.product-prices__value").innerText||""),""==a&&(a=m(".product-prices__price.product-prices__price--former-price span.product-prices__value").innerText||"");var p=a.replace("S/","");p=(p=p.replace("x","")).replace("kg",""),p=Ee.fixPrecio(p.trim());var u=s=(s=s.replace("https://","")).replace("/","");if("-1"==c){var l=d,m=l.indexOf(".pe/");m+=3;var h=l.substr(0,m),f=l.substr(m);fetch(h+"/api/catalog_system/pub/products/search"+f).then((function(e){return e.json()})).then((function(e){return g(e[0])}));var g=function(e){var t=e.categories[0];t=t.toLowerCase(),"-1"!=(t=Ee.quitarAcentos(t)).lastIndexOf("/")&&(t=t.slice(0,-1)),t=(t=Ee.quitarEspacios(t)).replace(",","");var a=e&&e.SkuData&&e.SkuData.length?e.SkuData[0]:n;a&&(a=(a=(a=(a=a.split(":")[0]).replace("{","")).replace('"',"")).replace('"',"")),r={name:o||e.productName,id:e.productReference,price:p||"",brand:i||e.brand,category:t||"",sku:a,variant:"",list:Ee.getLocal("lastCatalogo"),position:Ee.getVitrinaPosition(e.productReference)},Ee.productClick(Ee.getLocal("lastCatalogo"),r)}}else{var v=Ee.getSearchPosition(c);r={name:o,id:c,price:p||"",brand:i,category:u||"",sku:n,variant:"",list:Ee.getLocal("lastSearch"),position:v||Ee.getVitrinaPosition(c)},Ee.productClick(Ee.getLocal("lastSearch"),r)}}onProductDetail(e,t){var r=t.offsetParent.offsetParent.offsetParent,a=void 0,o=(l=function(e){return r.querySelector(e)||{}})(".product-prices__price.product-prices__price--better-price span.product-prices__value").innerText||"",i=r.dataset&&r.dataset.sku||"",n=r.dataset&&r.dataset.brand||"",c=r.dataset&&r.dataset.refid||"",s=r.dataset&&r.dataset.name||"",d=l("a").href;"-1"!=c&&(e=Ee.getLocal("lastSearch")),""!=n&&(n="."!=n?n.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),""==o&&(o=l(".product-prices__price.product-prices__price--regular-price span.product-prices__value").innerText||""),""==o&&(o=l(".product-prices__price.product-prices__price--former-price span.product-prices__value").innerText||"");var p=o.replace("S/","");p=(p=p.replace("x","")).replace("kg",""),p=Ee.fixPrecio(p.trim());var u=d,l=u.indexOf(".pe/");l+=3;var m=u.substr(0,l),h=u.substr(l);fetch(m+"/api/catalog_system/pub/products/search"+h).then((function(e){return e.json()})).then((function(e){return f(e[0])}));var f=function(t){var r=t&&t.SkuData&&t.SkuData.length?t.SkuData[0]:i;r&&(r=(r=(r=(r=r.split(":")[0]).replace("{","")).replace('"',"")).replace('"',"")),a={name:s||t.productName,id:t.productReference,price:p||"",brand:n||t.brand,category:t.categories[0]||"",sku:r,variant:""},Ee.productDetail(e,a)}}addToCartFromQuickSearch(e){var t,r=e.offsetParent,a=function(e){return r.querySelector(e)||{}},o=a(".product-item__name").innerText||"",i=a(".product-item__brand").innerText||"",n=a(".product-item__controls .product-quantity__input--hidden").value||"",c=r&&r.dataset&&r.dataset.price||"",s=r.dataset&&r.dataset.refid||"",d=r.dataset&&r.dataset.sku||"";""!=i&&(i="."!=i?i.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),c=(c=(c=c.replace("S/","")).replace("x","")).replace("kg","");var p=void 0;t={name:o,id:s,price:c=Ee.fixPrecio(c.trim()),brand:i,category:r.dataset&&r.dataset.category||"",sku:d,variant:"",quantity:n},(p={name:o,id:s,price:c,brand:i,category:r.dataset&&r.dataset.category||"",sku:d,variant:"",quantity:n}).list=Ee.getLocal("lastSearch"),p.position=Ee.getSearchPosition(s),this.onSingleClick(Ee.getLocal("lastSearch"),p),Ee.addCart(t)}addToCart(e,t){var r=this,a=e.offsetParent,o=void 0,i=(h=function(e){return a.querySelector(e)||{}})(".product-item__name").innerText||"",n=h(".product-item__brand").innerText||"",c=h(".product-item__controls .product-quantity__input--hidden").value||"",s=h(".product-prices__value").innerText||"",d=h(".product-prices__value--best-price").innerText||"";""!=n&&(n="."!=n?n.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),c=(c=c.replace("kg","")).trim(),d&&(s=d);var p=s.replace("S/","");p=(p=p.replace("x","")).replace("kg",""),p=Ee.fixPrecio(p.trim());var u=a.dataset&&a.dataset.refid||"",l=a.dataset&&a.dataset.sku||"";if(-1==a.dataset.refid){var m=a.dataset.uri,h=m.indexOf(".pe/");h+=3;var f=m.substr(0,h),g=m.substr(h);fetch(f+"/api/catalog_system/pub/products/search"+g).then((function(e){return e.json()})).then((function(e){return v(e[0])}));var v=function(e){var t=void 0,a=e.categories[0];a=a.toLowerCase(),"-1"!=(a=Ee.quitarAcentos(a)).lastIndexOf("/")&&(a=a.slice(0,-1)),a=(a=Ee.quitarEspacios(a)).replace(",",""),o={name:i,id:e.productReference,price:p||"",brand:n,category:a||"",sku:l,variant:"",quantity:c},(t={name:i,id:e.productReference,price:p||"",brand:n,category:a||"",sku:l,variant:"",quantity:c}).list=Ee.getLocal("lastCatalogo"),t.position=Ee.getVitrinaPosition(e.productReference),r.onSingleClick(Ee.getLocal("lastCatalogo"),t),Ee.addCart(o)}}else{var y=void 0;o={name:i,id:u,price:p||"",brand:n,category:a.dataset&&a.dataset.category||"",sku:l,variant:"",quantity:c},(y={name:i,id:e.productReference,price:p||"",brand:n,category:e.categories[0]||"",sku:l,variant:"",quantity:c}).list=Ee.getLocal("lastSearch"),y.position=Ee.getVitrinaPosition(e.productReference),this.onSingleClick(Ee.getLocal("lastSearch"),y),Ee.addCart(o)}}addToCartProductView(e){var t=document.querySelector(".inner.product"),r=function(e){return t.querySelector(e)||{}},a=r(".name").innerText||"",o=r("#___rc-p-sku-ids").value||"",i=r(".brand").innerText||"",n=r(".skuBestPrice").innerText||"",c=r(".prod-controls .product-quantity__input--hidden").value||"",s=t.querySelectorAll(".bread-crumb ul li a"),d=n.replace("S/","");d=(d=d.replace("x","")).replace("kg",""),d=Ee.fixPrecio(d.trim()),""!=i&&(i="."!=i?i.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),c=c.replace("kg","");var p=window.location.href;t=p.indexOf(".pe/");t+=3;var u=p.substr(0,t),l=p.substr(t);fetch(u+"/api/catalog_system/pub/products/search"+l).then((function(e){return e.json()})).then((function(e){return m(e[0])}));var m=function(e){var t=e&&e.SkuData&&e.SkuData.length?e.SkuData[0]:o;t&&(t=(t=(t=(t=t.split(":")[0]).replace("{","")).replace('"',"")).replace('"',""));var r={name:a,id:e.productReference,price:d,brand:i,category:s[s.length-1].pathname,sku:t,variant:"",quantity:c.trim()};Ee.addCart(r)}}addToCartQuickView(e){var t=e.offsetParent,r=function(e){return t.querySelector(e)||{}},a=r(".name").innerText||"",o=r(".product-quantity__input--hidden").dataset.sku||"",i=r(".aditional-info .brand").innerText||"",n=r(".prod-controls .product-quantity__input--hidden").value||"",c=r(".product-prices__price.product-prices__price--better-price span.product-prices__value").innerText||"";r(".categories").innerText;""==c&&(c=r(".product-prices__price.product-prices__price--regular-price span.product-prices__value").innerText||""),""==c&&(c=r(".product-prices__price.product-prices__price--former-price span.product-prices__value").innerText||"");var s=c.replace("S/","");s=(s=s.replace("x","")).replace("kg",""),s=Ee.fixPrecio(s.trim()),""!=i&&(i="."!=i?i.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda);var d=r(".is-available a").href,p=d.indexOf(".pe/");p+=3;var u=d.substr(0,p),l=d.substr(p);fetch(u+"/api/catalog_system/pub/products/search"+l).then((function(e){return e.json()})).then((function(e){return m(e[0])}));var m=function(e){var t=e&&e.SkuData&&e.SkuData.length?e.SkuData[0]:o;t&&(t=(t=(t=(t=t.split(":")[0]).replace("{","")).replace('"',"")).replace('"',"")),r={name:a,id:e.productReference,price:s,brand:i,category:e.categories[0]||"",sku:t,variant:"",quantity:n},Ee.addCart(r)}}addToCartMini(e){var t=this,r=e.offsetParent.offsetParent,a=function(e){return r.querySelector(e)||{}},o=a(".product-item__name").innerText||"",i=a(".product-item__brand").innerText||"",n=(a(".skuId").innerText,a(".product-item")),c=(n&&n.dataset&&n.dataset.sku,n&&n.dataset&&n.dataset.id||"");n&&n.dataset&&n.dataset.refid,n&&n.dataset&&n.dataset.category;""!=i&&(i="."!=i?i.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda);var s=a(".product-prices__price--regular-price .product-prices__value");""==(s&&s.dataset&&s.dataset.price||"")&&(s=a(".product-prices__price--better-price .product-prices__value"));var d=s&&s.dataset&&s.dataset.price||"";d=Ee.fixPrecio(d);var p=a(".product-item__info a").href,u=p.indexOf(".pe/");u+=3;var l=p.substr(0,u),m=p.substr(u);fetch(l+"/api/catalog_system/pub/products/search"+m).then((function(e){return e.json()})).then((function(e){return h(e[0])}));var h=function(e){var r=e&&e.SkuData&&e.SkuData.length?e.SkuData[0]:0;r=r?(r=(r=(r=r.split(":")[0]).replace("{","")).replace('"',"")).replace('"',""):c||0;var a={name:o,id:e.productReference,price:d,brand:i,category:e.categories[0]||"",sku:r,variant:"",quantity:1};t.onSingleClick("Minicar",a),Ee.addCart(a)}}addToCartBannerBraindw(e,t){var r=this,a=t.parent().parent()[0],o=$(a).find("a").attr("href"),i=$(a).find(".braindw_bigbannercategoria_title").text(),n=$(a).find(".braindw_bigbannercategoria_price").text(),c=parseFloat($(a).find(".product-quantity__input--hidden").val());""==i&&(i=$(a).find(".prateleira__name").text()),""==n&&(n=$(a).find(".prateleira__best-price").text());var s=n.replace("Online","");s=(s=s.replace("x kg","")).replace("S/",""),s=Ee.fixPrecio(s.trim());var d=o.indexOf(".pe/");d+=3;var p=o.substr(0,d),u=o.substr(d);fetch(p+"/api/catalog_system/pub/products/search"+u).then((function(e){return e.json()})).then((function(e){return l(e[0])}));var l=function(e){var t=e.brand||"";""!=t&&(t="."!=t?t.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda);var o=e&&e.SkuData&&e.SkuData.length?e.SkuData[0]:"";o&&(o=(o=(o=(o=o.split(":")[0]).replace("{","")).replace('"',"")).replace('"',"")),a={name:i,id:e.productReference,price:s||"",brand:t,category:e.categories[0]||"",sku:o,variant:"",quantity:c},r.onSingleClick("BannerBraindw",a),Ee.addCart(a)}}removeFromCart(e){var t=e.offsetParent.offsetParent,r=function(e){return t.querySelector(e)||{}},a=r(".product-item__name").innerText||"",o=r(".product-item__brand").innerText||"",i=(r(".categories").innerText,r(".product-prices__price--better-price .product-prices__value")),n=r(".product-item"),c=n&&n.dataset&&n.dataset.sku||"";if(""!=o&&(o="."!=o?o.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),""==(i&&i.dataset&&i.dataset.price||"")&&(i=r(".product-prices__price--regular-price .product-prices__value")),""==(i&&i.dataset&&i.dataset.refid||"")){var s=r(".product-item a").href,d=s.indexOf(".pe/");d+=3;var p=s.substr(0,d),u=s.substr(d);fetch(p+"/api/catalog_system/pub/products/search"+u).then((function(e){return e.json()})).then((function(e){return l(e[0])}));var l=function(e){var r=i&&i.dataset&&i.dataset.price||"";r=Ee.fixPrecio(r);var n=e&&e.SkuData&&e.SkuData.length?e.SkuData[0]:"";n&&(n=(n=(n=(n=n.split(":")[0]).replace("{","")).replace('"',"")).replace('"',""));var c={name:a,id:e&&e.productReference||t.dataset.refid,price:r,brand:o,category:e&&e.categories[0]||"",sku:n,variant:"",quantity:1};Ee.removeCart(c)}}else{var m={name:a,id:i&&i.dataset&&i.dataset.refid||"",price:i&&i.dataset&&i.dataset.price||"",brand:o,category:i&&i.dataset&&i.dataset.category||"",sku:c,variant:"",quantity:1};Ee.removeCart(m)}}removeItemFromCart(e){var t=e.offsetParent,r=function(e){return t.querySelector(e)||{}},a=r(".product-item__name").innerText||"",o=r(".product-item__brand").innerText||"",i=(r(".categories").innerText,r(".product-quantity__input--hidden").value||""),n=r(".product-prices__price--better-price .product-prices__value"),c=(r(".product-item"),a&&a.dataset&&a.dataset.sku||"");if(i=(i=i.replace("kg","")).trim(),""!=o&&(o="."!=o?o.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),""==(n&&n.dataset&&n.dataset.price||"")&&(n=r(".product-prices__price--regular-price .product-prices__value")),""==(n&&n.dataset&&n.dataset.refid||"")){var s=r(".product-item a").href,d=s.indexOf(".pe/");d+=3;var p=s.substr(0,d),u=s.substr(d);fetch(p+"/api/catalog_system/pub/products/search"+u).then((function(e){return e.json()})).then((function(e){return l(e[0])}));var l=function(e){var t=n&&n.dataset&&n.dataset.price||"";t=Ee.fixPrecio(t);var r=e&&e.SkuData&&e.SkuData.length?e.SkuData[0]:"";r&&(r=(r=(r=(r=r.split(":")[0]).replace("{","")).replace('"',"")).replace('"',""));var c={name:a,id:e.productReference,price:t,brand:o,category:e.categories[0]||"",sku:r,variant:"",quantity:i};Ee.removeCart(c)}}else{var m=n&&n.dataset&&n.dataset.price||"";m=Ee.fixPrecio(m);var h={name:a,id:n&&n.dataset&&n.dataset.refid||"",price:m,brand:o,category:n&&n.dataset&&n.dataset.category||"",sku:c,variant:"",quantity:i};Ee.removeCart(h)}}static getVitrinaPosition(e){var t="",r=$('.product-shelf[class*="colunas"]');if(r.length){var a=Array.from(r[0].querySelectorAll(".product-shelf ul li")).filter((function(e){return e.childElementCount>0})),o=1;a.length>18&&(o=parseInt(a.length/18),a.length%18!=0&&(o+=1),a=a.slice(18*(o-1),a.length)),a.map((function(r,a){var i=r,n=function(e){return function(e){return i.querySelector(e)||{}}(e).dataset||{}}(".product-item").uri||"";if(0!=n){var c=(n=n.substring(n.length-2,0)).split("-");n=c[c.length-1]}n==e&&(t=a+1+18*(o-1))}))}return t}productsImpressionScroll(e,t,r){var a=[];if(t.length){var o=Array.from(t[0].querySelectorAll(".product-shelf ul li")).filter((function(e){return e.childElementCount>0})),i=1;o.length>18&&(i=parseInt(o.length/18),o.length%18!=0&&(i+=1),o=o.slice(18*(i-1),o.length)),o.map((function(t,o){var n=Ee.formatProductData(e,t,o+1+18*(i-1),r);a.push(n)})),a.length&&Ee.impress(a)}}onSlider(){let e=[];$(".sliderHolder--main .sliderHolder__slides .adaptive-image:not(.bx-clone)").each((function(t){$(this).find("img").attr("src");$(this).find("a").each((function(){e.push({id:$(this).attr("id"),name:$(this).attr("data-name"),creative:"Slider Principal",position:"slot"+(t+1)})}))})),e.length&&Ee.promotions(e)}onCarrousel(){let e=[];$(".sliderHolder__slides .box-banner a img").each((function(t){e.push({id:$(this).attr("id"),name:$(this).attr("alt"),creative:"Carrousel Principal",position:"slot"+(t+1)})})),e.length&&Ee.promotions(e)}static getPositionCarrousel(e){var t="";return $(".sliderHolder__slides .box-banner a img").each((function(r){$(this).attr("id")==e&&(t="slot"+(r+1))})),t}static getPositionAhorro(e){var t="";return $(".agenda-del-ahorro .column .box-banner a img").each((function(r){$(this).attr("id")==e&&(t="slot"+(r+1))})),t}onAhorro(){let e=[];$(".agenda-del-ahorro .columns .column .box-banner a img").each((function(t){e.push({id:$(this).attr("id"),name:$(this).attr("alt"),creative:"Carrousel Ahorro",position:"slot"+(t+1)})})),e.length&&Ee.promotions(e)}listAddToCart(e,t){var r=void 0,a=[];$.get("/api/catalog_system/pub/products/search/?"+e,(function(e){Object.keys(JSON.stringify(e)).map((function(o){if(e[o]){var i=e[o],n=t.find((function(e){return e.sku===i.items[0].itemId}));i.items[0].sellers[0].commertialOffer.Price&&(r={name:i.productName,id:i.productReference,brand:"."!=i.brand?i.brand:sTienda,quantity:n.quantity?n.quantity:1,price:i.items[0].sellers[0].commertialOffer.Price,sku:i.items[0].itemId,category:i.categories[0],variant:""},a.push(r))}}));Ee.productListClick("Listas",a),Ee.listAddCart(a)}))}static promoClicked(e){dataLayer.push({event:"promotionClick",ecommerce:{promoClick:{promotions:e}}})}static getPositionSlider(e){var t="";return $(".sliderHolder--main .sliderHolder__slides .adaptive-image:not(.bx-clone)").each((function(r){$(this).find("a").each((function(){e==$(this).attr("id")&&(t="slot"+(r+1))}))})),t}promoSliderClicked(e){var t=[],r=$(e).attr("id"),a=$(e).attr("data-name"),o=Ee.getPositionSlider(r);t.push({id:r,name:a,creative:"Slider Principal",position:o}),Ee.promoClicked(t)}static getPosition(e,t){var r="";return $(e+">.columns>.column>.box-banner.btnHover>a").each((function(e){$(this).find("img").attr("id")==t&&(r="slot"+(e+1))})),r}promoGondolaClicked(e){var t=[],r=$(e).find("img").attr("id"),a=$(e).find("img").attr("alt"),o=$(e.offsetParent.parentElement).find(">.catHome__title>h3").text(),i=$(e.offsetParent.parentElement).attr("id"),n=Ee.getPosition("#"+i,r);t.push({id:r,name:a,creative:"Góndola "+o,position:n}),Ee.promoClicked(t)}promoCarrouselClicked(e){var t=[],r=$(e).find("img").attr("id"),a=$(e).find("img").attr("alt"),o=Ee.getPositionCarrousel(r);t.push({id:r,name:a,creative:"Carrousel Principal",position:o}),Ee.promoClicked(t)}promoAhorroClicked(e){var t=[],r=$(e).find("img").attr("id"),a=$(e).find("img").attr("alt"),o=Ee.getPositionAhorro(r);t.push({id:r,name:a,creative:"Carrousel Ahorro",position:o}),Ee.promoClicked(t)}}var myshop=new Ee(sTienda);const baseGondola=e=>{let t=[];const r=$(e+">.catHome__title>h3").text();return $(e+">.columns>.column>.box-banner.btnHover>a").each((function(e){t.push({id:$(this).find("img").attr("id"),name:$(this).find("img").attr("alt"),creative:"Góndola "+r,position:"slot"+(e+1)})})),t};$(document).ready((function(){var e=void 0;if($(document).ajaxComplete((function(t,r,a){if(a.url.toString().includes("/api/catalog_system/pub/products/search/?ft=")){var o=$("#search-autocomplete-input").val();o.replace(/\s/g,"")!==e&&""!==o&&"block"===$(".results-wrapper").css("display")&&(dataLayer.push({event:"impressions",ecommerce:{currencyCode:"PEN",impressions:Ee.Search(".search-text-products","Busqueda_rapida: "+o)}}),e=o),o=o.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})),Ee.setLocal("lastSearch","Busqueda_rapida: "+o),dataLayer.push({ecommerce:void 0}),t.preventDefault()}if(a.url.toString().includes("/api/catalog_system/pub/products/search"))if(a.url.toString().includes("&fq=B")){var i=Ee.getParList(),n=$('.product-shelf[class*="colunas"]');setTimeout((function(){myshop.productsImpressionScroll("category",n,i)}),800),t.preventDefault()}else if(a.url.toString().includes("&O=Order")){if($("body").hasClass("department")||$("body").hasClass("category")||$("body").hasClass("search-result-simple")){i=Ee.getParList(),n=$('.product-shelf[class*="colunas"]');setTimeout((function(){myshop.productsImpressionScroll("category",n,i)}),800)}t.preventDefault()}else if(!a.url.toString().includes("?ft=")&&!a.url.toString().includes("fq=skuId")&&!a.url.toString().includes("fq=productId")&&($("body").hasClass("department")||$("body").hasClass("category")||$("body").hasClass("search-result-simple"))){i=Ee.getParList(),n=$('.product-shelf[class*="colunas"]');setTimeout((function(){myshop.productsImpressionScroll("category",n,i)}),800),t.preventDefault()}})),$("body").hasClass("department")||$("body").hasClass("category")||$("body").hasClass("search-result-simple")){var t=Ee.getParList(),r=$('.product-shelf[class*="colunas"]');myshop.productsImpressionScroll("category",r,t)}$("body").is(".account, .shopping-list")&&$(document).on("click",elem.shopListItemAddToCart,(function(){var e=$(this).parents(elem.shopListItem),t=(e=(e=e.find(".list-item__actions a").attr("href")).split("="))[1],r=JSON.parse(Fizzmod.ShoppingList.listDataCache[t].skus),a=Object.keys(r).map((function(e){return{sku:e,quantity:r[e].quantity}})),o=Object.keys(r).map((function(e){return"fq=skuId:"+e})).join("&");myshop.listAddToCart(o,a)})).on("click","button.shop-list__action.shop-list__action--buy-selected.btn.primary-border",(function(){var e=$(".list-item--is-selected"),t=[];if(!e.length)return console.log("No list selected");if(e.each((function(e){var r=$(this);r=(r=r.find(".list-item__actions a").attr("href")).split("=");var a=Fizzmod.ShoppingList.listDataCache[r[1]],o=JSON.parse(a.skus);for(var i in o){var n={};n.sku=i,n.id=i,n.quantity=1,n.seller=1,t.push(n)}})),t.length){var r=t.map((function(e){return"fq=skuId:"+e.id})).join("&");myshop.listAddToCart(r,t)}}));var a=window.location.hash,o="";if(window.addEventListener("hashchange",(function(){if("#/email"===(a=window.location.hash)&&$("body").hasClass("emailStep")&&(Ee.setLocal("goemail",0),Ee.setLocal("goprofile",1)),"#/profile"===a&&$("body").hasClass("profileStep")&&(myshop.onInteraction("profile"),Ee.setLocal("goprofile",0),0!=Ee.getLocal("goemail")&&myshop.onCheckout({step:2},vtexjs.checkout.orderForm),Ee.setLocal("goemail",0),vtexjs.checkout.getOrderForm().done((function(e){var t={step:3,option:"Quiero Boleta"};vtexjs.checkout.orderForm.clientProfileData&&(t=vtexjs.checkout.orderForm.clientProfileData.isCorporate?{step:3,option:"Quiero Factura"}:{step:3,option:"Quiero Boleta"}),myshop.onCheckout(t,e)})),$("#is-corporate-client").click((function(e){myshop.onCheckoutOption(3,"Quiero Factura"),e.stopPropagation()})),$("#not-corporate-client").click((function(e){myshop.onCheckoutOption(3,"Quiero Boleta"),e.stopPropagation()})),$("#opt-in-promotions").click((function(){document.querySelectorAll("#opt-in-promotions")[0].checked?myshop.onCheckoutOption(3,"Quiero recibir newsletter"):myshop.onCheckoutOption(3,"Sin newsletter")}))),"#/shipping"===a&&$("body").hasClass("shippingStep")){myshop.onInteraction("shipping"),1!=Ee.getLocal("goemail")&&null==Ee.getLocal("sp-email")||1!=Ee.getLocal("gopayment")||(myshop.onCheckout({step:2},vtexjs.checkout.orderForm),myshop.onCheckout({step:3,option:"Quiero Boleta"},vtexjs.checkout.orderForm)),Ee.setLocal("goemail",0),Ee.setLocal("goprofile",0);var e=vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla?vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla:"Retiro en Tienda";o={step:4,option:e},myshop.onCheckout(o,vtexjs.checkout.orderForm);var t=vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla;$("#shipping-data").on("click",(function(e){t!=vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla&&(myshop.onCheckoutOption(4,vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla),t=vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla),e.stopPropagation()}))}if("#/payment"===a&&$("body").hasClass("paymentStep")){if(myshop.onInteraction("payment"),1==Ee.getLocal("goemail")){myshop.onCheckout({step:2},vtexjs.checkout.orderForm),myshop.onCheckout({step:3,option:"Quiero Boleta"},vtexjs.checkout.orderForm);e=vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla?vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla:"Retiro en Tienda";o={step:4,option:e},myshop.onCheckout(o,vtexjs.checkout.orderForm)}else if(1==Ee.getLocal("goprofile")){myshop.onCheckout({step:3,option:"Quiero Boleta"},vtexjs.checkout.orderForm);e=vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla?vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla:"Retiro en Tienda";o={step:4,option:e},myshop.onCheckout(o,vtexjs.checkout.orderForm)}Ee.setLocal("goemail",0),Ee.setLocal("goprofile",0),Ee.setLocal("gopayment",0),o={step:5,option:s="Pago en Línea"},myshop.onCheckout(o,vtexjs.checkout.orderForm);var r="";vtexjs.checkout.getOrderForm().done((function(e){r=e})),r||(r=vtexjs.checkout.orderForm);var i=r.paymentData.paymentSystems,n=r.paymentData.payments[0].paymentSystem,c=i.findIndex((function(e){return e.id==n})),s=r.paymentData.paymentSystems[c].name;0==Ee.getLocal("goprofile")&&myshop.onCheckoutOption(5,s),$(".payment-group-item").on("click",(function(e){s!=$(this).children("span").text()&&myshop.onCheckoutOption(5,$(this).children("span").text()),s=$(this).children("span").text(),e.preventDefault()}))}})),$(document).on("click","div.product-item__image-wrapper",(function(e){var t=e.currentTarget;myshop.onProductClick(t)})).on("click","a.product-item__name",(function(e){var t=e.currentTarget;myshop.onProductClick(t)})).on("click",".search-text-products .product-item__add-to-cart.product-add-to-cart.btn.red.add-to-cart",(function(e){var t=e.currentTarget;myshop.addToCartFromQuickSearch(t)})).on("click","li .product-item__add-to-cart.product-add-to-cart.btn.red.add-to-cart",(function(e){var t=e.currentTarget;myshop.addToCart(t)})).on("click",".compare__product button.product-item__add-to-cart.product-add-to-cart.btn.red.add-to-cart",(function(e){var t=e.currentTarget;myshop.addToCart(t,"compare__product")})).on("click",".product-add-to-cart.product-add-to-cart--quickview.btn.red.add-to-cart",(function(e){var t=e.currentTarget;myshop.addToCartQuickView(t)})).on("click",".product-add-to-cart.product-add-to-cart--product-view.btn.red.add-to-cart",(function(e){var t=document.querySelectorAll(".inner.product .product-info");myshop.addToCartProductView(t)})).on("click",".minicart__products .product-quantity__control--increase",(function(e){var t=e.currentTarget;myshop.addToCartMini(t)})).on("click","body.cart .product-quantity__control.product-quantity__control--increase",(function(e){var t=e.currentTarget;myshop.addToCartMini(t)})).on("click",".product-shelf.li.product-item.product-item__controls.product-item__add-to-cart",(function(e){var t=e.currentTarget;myshop.addToCart(t,"Resultado_busqueda")})).on("click","li button.product-add-to-cart.btn.add-to-cart.braindw_addToCart._braindwTriggerClick",(function(e){var t=e.currentTarget;myshop.addToCartBannerBraindw(t,$(this))})).on("click",".braindw_hadj button.product-add-to-cart.btn.red.add-to-cart._braindwTriggerClick",(function(e){var t=e.currentTarget;myshop.addToCartBannerBraindw(t,$(this))})).on("click",".minicart__products .item-remove",(function(e){var t=e.currentTarget;myshop.removeItemFromCart(t)})).on("click",".minicart__products .product-quantity__control--decrease",(function(e){var t=e.currentTarget;myshop.removeFromCart(t)})).on("click","body.cart .product-quantity__control.product-quantity__control--decrease",(function(e){var t=e.currentTarget;myshop.removeFromCart(t)})).on("click","body.cart .item-remove",(function(e){var t=e.currentTarget;myshop.removeItemFromCart(t)})).on("click","a.product-item__action.product-item__action--quickview",(function(e){var t=e.currentTarget;setTimeout((function(){myshop.onProductDetail(Ee.getLocal("lastCatalogo"),t)}),800)})),$("body").hasClass("home")){myshop.onSlider(),myshop.onCarrousel();[baseGondola("#gondola-1"),baseGondola("#gondola-2"),baseGondola("#gondola-3"),baseGondola("#gondola-4"),baseGondola("#gondola-5"),baseGondola("#gondola-6")].map((e=>{e.length&&(dataLayer.push({event:"promotionsView",ecommerce:{promoView:{promotions:e}}}),dataLayer.push({ecommerce:void 0}))})),myshop.onAhorro(),$(".content-wrapper .column").on("click","a",(function(e){myshop.promoGondolaClicked(e.currentTarget)})),$(".sliderHolder .adaptive-image").on("click","a",(function(e){myshop.promoSliderClicked(e.currentTarget)})),$(".sliderHolder__slides .box-banner").on("click","a",(function(e){myshop.promoCarrouselClicked(e.currentTarget)})),$(".agenda-del-ahorro .column .box-banner").on("click","a",(function(e){myshop.promoAhorroClicked(e.currentTarget)}))}})),$(window).load((function(){var e=window.location.hash,t="";if($("body").hasClass("product")){var r=".product-wrapper .info-wrapper";dataLayer.push({event:"productDetail",ecommerce:{detail:{actionField:{list:"Ficha de producto"},products:[{name:$(r).find(".productName").text().replace(/"/g,""),id:$(r).find("span.code div").text(),price:Ee.buscarPrecioEnFicha($(r)),brand:"."!=$(r).find(".brandName").text()?$(r).find(".brandName").text():sTienda,category:new URL($(".info-wrapper .brandName .brand").attr("href")).pathname.split("/",4).join("/"),sku:$("input[type=hidden][id=___rc-p-sku-ids]").val(),variant:""}]}}}),dataLayer.push({ecommerce:void 0})}if($("body").hasClass("cart")&&(Ee.setLocal("goemail",1),Ee.setLocal("goprofile",1),Ee.setLocal("gopayment",1),myshop.onInteraction("cart"),t={step:1,option:"Criterio Metro"},vtexjs.checkout.getOrderForm().done((function(e){myshop.onCheckout(t,e)})),$(".item-preference").click((function(){myshop.onCheckoutOption(1,$(this).text())}))),"#/email"===e&&$("body").hasClass("emailStep")&&(Ee.setLocal("goemail",0),Ee.setLocal("goprofile",1),myshop.onInteraction("email"),t={step:2},vtexjs.checkout.getOrderForm().done((function(e){myshop.onCheckout(t,e)}))),"#/shipping"===e&&$("body").hasClass("shippingStep")){var a=vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla;$("#shipping-data").on("click",(function(e){a!=vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla&&(myshop.onCheckoutOption(4,vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla),a=vtexjs.checkout.orderForm.shippingData.logisticsInfo[0].selectedSla),e.stopPropagation()}))}if("#/payment"===e&&$("body").hasClass("paymentStep")){var o="";vtexjs.checkout.getOrderForm().done((function(e){o=e})),o||(o=vtexjs.checkout.orderForm);var i=o.paymentData.paymentSystems,n=(r=o.paymentData.payments[0].paymentSystem,i.findIndex((function(e){return e.id==r}))),c=o.paymentData.paymentSystems[n].name;$(".payment-group-item").on("click",(function(e){c!=$(this).children("span").text()&&myshop.onCheckoutOption(5,$(this).children("span").text()),c=$(this).children("span").text(),e.preventDefault()}))}$("body").hasClass("shopping-list")&&$(document).on("click","button.shop-list-detail__action.shop-list-detail__action--buy-selected.btn.red-border",(function(e){var t=[];$("input:checked").length&&($("input[type=checkbox]:checked").map((function(){var e=$(this).parent().parent(),r=e[0].dataset,a=e.find(".product-item__info a")[0]||"",o=e.find(".product-prices__value")[0]||"",i=e.find(".product-item__brand")[0]||"",n=e.find(".product-quantity__input")[0]||"",c=a.href;if(c.length>0){var s=(c=c.substring(c.length-2,0)).split("-");c=s[s.length-1]}else c="";i&&i.innerText&&(i=i.innerText||""),""!=i&&(i="."!=i?i.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),o.dataset&&o.dataset.price&&t.push({name:a.innerText||"",id:c,price:o.dataset.price||"",brand:i,category:r.category||"",sku:r.sku||"",variant:"",quantity:n.value})})),Ee.productListClick("Listas",t),Ee.listAddCart(t))}))})),$(document).ajaxStop((function(e,t,r){var a=Ee.getLocal("last_order");if($("body").hasClass("body-checkout-confirmation")){var o=$("#order-id").text().split("-")[0],i=/qa/.test(window.location.host)?"https://www.pruebasqa.metro.pe":"https://www.metro.pe";fetch(`${i}/api/checkout/pub/orders/order-group/${o}`).then((function(e){return e.json()})).then((function(e){return n(e)}));var n=function(e){o!=a&&myshop.onInteraction("purchase"),$.each(e,(function(e,t){var r={id:t.orderId,affiliation:sTienda,revenue:Ee.fixPrecio(t.value/100),tax:"0.18",shipping:t.totals?t.totals[2].value/100:0},i=[];t.items.forEach((function(e){var t=e.additionalInfo.brandName||"";""!=t&&(t="."!=t?t.toLowerCase().replace(/\b[a-z]/g,(function(e){return e.toUpperCase()})):sTienda),i.push({name:e.name,id:e.refId,price:Ee.fixPrecio(e.price/100),brand:t,category:Object.values(e.productCategories).join("/"),sku:e.id,variant:"",quantity:e.quantity})})),o!=a&&myshop.onPurchase(r,i)})),Ee.setLocal("last_order",o),Ee.removeLocal("goprofile"),Ee.removeLocal("goemail")}}}));